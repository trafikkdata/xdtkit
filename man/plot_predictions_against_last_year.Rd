% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plot_predictions_against_last_year}
\alias{plot_predictions_against_last_year}
\title{Plot AADT predictions against last year's values}
\usage{
plot_predictions_against_last_year(
  directed_predictions,
  heavy_vehicle = FALSE,
  balanced = TRUE,
  log10_axis = FALSE,
  color_by = NULL,
  facet_by = NULL,
  facet_by_2 = NULL,
  facet_scales = "fixed"
)
}
\arguments{
\item{directed_predictions}{A data frame containing prediction columns and
last year's AADT values. Must include columns: `inla_pred`, `balanced_pred`,
`inla_pred_heavy`, `balanced_pred_heavy`, `lastYearAadt_aadt`, and
`lastYearAadt_heavyAadt`.}

\item{heavy_vehicle}{Logical. If `TRUE`, plots heavy vehicle predictions and
last year values. If `FALSE` (default), plots total AADT.}

\item{balanced}{Logical. If `TRUE` (default), uses flow-balanced predictions.
If `FALSE`, uses raw INLA predictions without flow conservation constraints.}

\item{log10_axis}{Logical. If `TRUE`, applies pseudo-log transformation
(base 10) to both axes, which handles zero values gracefully while
maintaining log-like scaling for larger values. If `FALSE` (default),
uses linear scales.}
}
\value{
A ggplot2 object showing predictions (y-axis) vs last year's AADT
  (x-axis) with a 1:1 reference line (dashed red). The plot can be further
  customized using standard ggplot2 functions.
}
\description{
Creates a scatter plot comparing predicted AADT values against the previous
year's AADT, with optional log scaling. Useful for assessing year-over-year
prediction stability and identifying segments with large changes.
}
\details{
The function automatically selects the appropriate prediction and last year
columns based on the `heavy_vehicle` and `balanced` arguments:
\itemize{
  \item For total AADT: uses `balanced_pred` or `inla_pred` vs `lastYearAadt_aadt`
  \item For heavy vehicles: uses `balanced_pred_heavy` or `inla_pred_heavy`
        vs `lastYearAadt_heavyAadt`
}

The 1:1 reference line (red dashed) indicates perfect agreement with last
year's values. Points above the line indicate increased predicted traffic;
points below indicate decreased predicted traffic.

When `log10_axis = TRUE`, the function uses `scales::pseudo_log_trans()`
which behaves like log10 for large values but handles zeros smoothly without
requiring data transformation or filtering.
}
\examples{
\dontrun{
# Basic plot with balanced predictions on linear scale
plot_predictions_against_last_year(directed_predictions)

# Heavy vehicle predictions with log scale
plot_predictions_against_last_year(
  directed_predictions,
  heavy_vehicle = TRUE,
  log10_axis = TRUE
)

# INLA predictions without flow balancing
plot_predictions_against_last_year(
  directed_predictions,
  balanced = FALSE
)

# Further customize the plot
plot_predictions_against_last_year(directed_predictions, log10_axis = TRUE) +
  ggplot2::theme_bw() +
  ggplot2::labs(subtitle = "2024 predictions")
}

}
