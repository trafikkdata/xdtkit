% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plot_prediction_uncertainty}
\alias{plot_prediction_uncertainty}
\title{Plot Prediction Uncertainty vs. Predicted AADT}
\usage{
plot_prediction_uncertainty(
  directed_predictions,
  heavy_vehicle = FALSE,
  balanced = TRUE,
  log10_x = FALSE,
  log10_y = FALSE,
  color_by = NULL,
  alpha = 0.5,
  cap_sd = NULL,
  title_text = NULL,
  facet_by = NULL,
  facet_by_2 = NULL,
  facet_scales = "fixed"
)
}
\arguments{
\item{directed_predictions}{A data frame containing prediction and uncertainty
columns. Must include columns: `inla_pred`, `balanced_pred`, `inla_pred_heavy`,
`balanced_pred_heavy`, `inla_sd`, `balanced_sd`, `inla_sd_heavy`,
`balanced_sd_heavy`, and optionally `has_measurement` or similar indicator.}

\item{heavy_vehicle}{Logical. If `TRUE`, plots heavy vehicle predictions and
uncertainties. If `FALSE` (default), plots total AADT.}

\item{balanced}{Logical. If `TRUE` (default), uses flow-balanced predictions
and uncertainties. If `FALSE`, uses raw INLA predictions.}

\item{log10_x}{Logical. If `TRUE`, applies pseudo-log transformation (base 10)
to the x-axis (predicted AADT). If `FALSE` (default), uses linear scale.}

\item{log10_y}{Logical. If `TRUE`, applies pseudo-log transformation (base 10)
to the y-axis (standard deviation). If `FALSE` (default), uses linear scale.}

\item{color_by}{Character string specifying a column name to color points by
(e.g., "has_measurement", "vegkategori", "functional_road_class").
If `NULL` (default), all points are the same color.}

\item{alpha}{Numeric between 0 and 1 controlling point transparency.
Default is 0.5. Lower values help with overplotting.}
}
\value{
A ggplot2 object showing standard deviation (y-axis) vs predicted
  AADT (x-axis). The plot can be further customized using standard ggplot2
  functions.
}
\description{
Creates a scatter plot showing prediction uncertainty (standard deviation)
against predicted AADT values. Useful for understanding how uncertainty
scales with traffic volume and identifying segments with high uncertainty.
}
\details{
The function automatically selects the appropriate prediction and uncertainty
columns based on the `heavy_vehicle` and `balanced` arguments.

When `color_by` is specified, points are colored by the values in that column.
This is particularly useful for:
\itemize{
  \item Distinguishing measured vs. unmeasured segments (`has_measurement`)
  \item Comparing uncertainty across road classes (`vegkategori`, `functional_road_class`)
  \item Identifying spatial patterns (`fylke`, `kommune`)
}

Using pseudo-log transformations (`log10_x` or `log10_y`) helps visualize
data spanning multiple orders of magnitude while handling zeros gracefully.
}
\examples{
\dontrun{
# Basic uncertainty plot
plot_prediction_uncertainty(directed_predictions)

# Log scale for both axes
plot_prediction_uncertainty(
  directed_predictions,
  log10_x = TRUE,
  log10_y = TRUE
)

# Color by measurement availability
plot_prediction_uncertainty(
  directed_predictions,
  color_by = "has_measurement",
  log10_x = TRUE
)

# Compare INLA vs balanced uncertainty for heavy vehicles
library(patchwork)
p1 <- plot_prediction_uncertainty(
  directed_predictions,
  heavy_vehicle = TRUE,
  balanced = FALSE,
  log10_x = TRUE
)
p2 <- plot_prediction_uncertainty(
  directed_predictions,
  heavy_vehicle = TRUE,
  balanced = TRUE,
  log10_x = TRUE
)
p1 + p2
}

}
